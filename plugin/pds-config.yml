services:
  pds-config:
    image: zooh/pds-config:0.1.0
    environment:
      MONGO_HOST: pds-config-mongodb
      MONGO_PORT: 27017
      MONGO_DATABASE: db
      MONGO_COLLECTION: collection
      MONGO_NON_ROOT_USERNAME: pds
      MONGO_NON_ROOT_PASSWORD: aaa
      DEFAULT_CONFIG: |
        {
          "aggregator_plugin_id": "pds-aggregator",
          "phenotype_mapping_plugin_id": "pds-phenotype-mapping",
          "data_provider_plugin_id": "pds-data-provider-mock-fhir",
          "profile_plugin_id": "pds-profile",
          "model": [{
            "drug": "d1",
            "indications": [{
              "indication": "i1",
              "model_plugin_id": "pdsmpi-ref"
            }]
          }]
        }
    port: 8080
    depends_on:
      - pds-config-mongodb
  pds-config-mongodb:
    image: zooh/pds-mock-fhir-mongodb:0.1.0
    environment:
      MONGO_INITDB_ROOT_USERNAME: a
      MONGO_INITDB_ROOT_PASSWORD: a
      MONGO_INITDB_DATABASE: db
      MONGO_NON_ROOT_USERNAME: pds
      MONGO_NON_ROOT_PASSWORD: aaa
    port: 8080



